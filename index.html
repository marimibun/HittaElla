<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ritual Scrying Terminal</title>
    <!-- Load Tailwind CSS --><script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* =========================================================================
         * STYLING & AESTHETICS (Occult/Ancient Theme)
         * ========================================================================= */
        :root {
            /* Occult Color Palette */
            --occult-bg: #10081C;       /* Deep Amethyst/Black - Main Background */
            --occult-panel-bg: #211531; /* Darker Purple for containers/panels */
            --occult-primary: #9C4D56;  /* Muted Maroon/Blood Red - Accent/Borders */
            --occult-secondary: #4A205B;/* Deep Amethyst - Secondary Accent */
            --occult-text: #E0D4B8;     /* Distressed Parchment/Bone - Text */
            --occult-glow-red: #FF0000; /* Pure Red for intensity/danger */
            --occult-glow-shadow: 0 0 15px rgba(255, 0, 0, 0.7);
        }
        body {
            font-family: 'Inter', Tahoma, Verdana, sans-serif;
            background-color: var(--occult-bg);
            color: var(--occult-text); 
        }

        /* Main Panel Container (Replaces win7-dialog) */
        .occult-panel {
            background-color: var(--occult-panel-bg);
            border: 2px solid var(--occult-primary); /* Heavy, sharp border */
            border-radius: 0; /* Sharp corners */
            box-shadow: 0 0 50px rgba(156, 77, 86, 0.2), 0 5px 25px rgba(0, 0, 0, 0.8); 
            padding: 24px;
        }

        /* Title Bar Simulation (Replaces win7-title) */
        .occult-title-bar {
            color: var(--occult-text);
            background-color: var(--occult-secondary); 
            border-bottom: 2px solid var(--occult-primary);
            padding: 12px 15px;
            font-size: 1.25rem;
            font-weight: bold;
            margin: -24px -24px 0 -24px; 
            text-shadow: 0 0 5px #ff000050; /* Subtle glow */
        }
        
        /* Custom Button Styling (Replaces win7-button) */
        .occult-button {
            background-color: var(--occult-secondary);
            color: var(--occult-text);
            border: 1px solid var(--occult-primary);
            box-shadow: 0 0 5px var(--occult-secondary);
            cursor: default;
            transition: all 0.2s;
            border-radius: 0; /* Sharp corners */
        }
        
        /* Activated Button Style (Ritual Green/Glow) */
        .occult-button:not(:disabled) {
            background: #4e8a2a; /* Deep sickly green */
            border-color: #3b6b21;
            color: white;
            box-shadow: 0 0 15px rgba(106, 168, 79, 0.8); /* Intense green glow */
            cursor: pointer;
        }
        
        /* Red Button Style (Blood Red) */
        .occult-button-red {
            background-color: #A13D3D; 
            border-color: var(--occult-primary);
            color: white;
            box-shadow: 0 0 10px rgba(209, 79, 79, 0.9); /* Red glow */
            cursor: pointer;
            border-radius: 0;
        }
        .occult-button-red:hover {
            background-color: #D14F4F;
        }

        /* Custom styling for Input Fields (Password) */
        input[type="text"] {
            background-color: #10081C; /* BG matches main screen */
            color: var(--occult-text);
            border: 1px solid var(--occult-primary); 
            transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
            box-shadow: inset 0 0 5px rgba(255, 0, 0, 0.2);
            border-radius: 0;
        }
        input[type="text"]:focus {
            border-color: var(--occult-glow-red); 
            box-shadow: inset 0 0 5px var(--occult-glow-red), 0 0 0 2px rgba(255, 0, 0, 0.4); 
        }
        
        /* Modal Overlay and Flashing Text */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8); 
            backdrop-filter: blur(2px); 
            z-index: 1000; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
        }
        
        /* Flashing Animation */
        @keyframes flashing {
            0%, 100% { color: var(--occult-glow-red); text-shadow: 0 0 12px var(--occult-glow-red); } 
            50% { color: #800000; text-shadow: none; }
        }
        .flashing-text {
            animation: flashing 0.4s infinite alternate; 
        }
        
        /* Status Box */
        #statusContainer .status-box {
            background-color: #311A4D; /* Deep Amethyst */
            border: 1px solid var(--occult-primary);
            color: var(--occult-text);
            border-radius: 0;
        }
        
        /* Countdown Display - Runic/Inscribed Look */
        #countdownDisplay {
            font-family: monospace;
            font-size: 3.5rem; /* Larger */
            font-weight: 700;
            color: var(--occult-primary);
            text-shadow: 0 0 20px rgba(156, 77, 86, 0.9); /* Heavy, primary glow */
            letter-spacing: 0.2em; /* Wider spacing for an engraved look */
            padding: 10px 0;
            line-height: 1;
        }

        /* Video element styling for the main feed */
        #mainVideoFeed {
            width: 100%;
            max-width: 600px;
            aspect-ratio: 16 / 9; 
            border: 5px solid var(--occult-glow-red); /* Thick red border */
            border-radius: 0;
            box-shadow: 0 0 30px rgba(255, 0, 0, 0.9); /* Massive red glow */
            background-color: black;
            margin-top: 20px;
        }
        
        /* Endgame Modal - Even more intense */
        .occult-endgame-modal .occult-title-bar {
            background: var(--occult-glow-red);
            border-bottom: 3px solid white;
            color: black;
            text-shadow: none;
        }
        .occult-endgame-modal .occult-panel {
            background-color: #000000; /* Pure black center */
            border-color: white;
            box-shadow: 0 0 50px white;
        }

    </style>
</head>
<body class="p-4 md:p-8 min-h-screen flex items-start justify-center">
    
    <!-- SINGLE AUDIO PLAYER FOR ALL SOUNDS (Main loop/Alert) -->
    <audio id="audioPlayer" loop>
        <!-- Retained the original spooky audio link -->
        <source id="audioSource" src="https://res.cloudinary.com/dv6jfgesm/video/upload/v1760435544/Creepy_Little_Girl_Laughing_Giggling_Scary_Horror_Sound_Effect_creepylaughing_scarysound_azo3hd.mp3">
        Your browser does not support the audio element.
    </audio>

    <!-- MAIN WINDOW CONTAINER -->
    <div class="w-full max-w-2xl p-6 space-y-6 occult-panel">
        <h1 class="occult-title-bar">
            Scrying Engine v1.1 - The Crimson Seal
        </h1>
        
        <!-- SECTION 1: INPUT AND ACTIVATION (Visible Initially) -->
        <div id="inputArea" class="space-y-4 pt-4">
            <p class="text-sm text-gray-400"> 
                Whisper the **Rite of Access** to initiate the dimensional link.
            </p>

            <div class="flex flex-col sm:flex-row gap-4">
                <input type="text" id="passwordInput" placeholder="The Whisper of the Gate"
                       class="flex-1 w-full p-3 outline-none"
                       oninput="checkPassword()"> <!-- CRITICAL: This calls the function on every keystroke -->
            </div>

            <button id="verifyButton" disabled
                    class="w-full py-3 px-4 text-lg font-semibold transition duration-300 occult-button">
                Inscribe the Link
            </button>
        </div>

        <!-- SECTION 2: VIDEO/COUNTDOWN/STATUS AREA (Hidden initially) -->
        <div id="resultArea" class="hidden space-y-6 pt-4">
            
            <!-- TOP STATUS ROW: Live Feed Status -->
            <div class="flex flex-col gap-6">
                
                <!-- LIVE FEED STATUS CONTAINER -->
                <div id="statusContainer" class="flex-grow text-center">
                    <h2 id="loadingTitle" class="text-2xl font-bold text-red-700 mb-2" style="color: var(--occult-primary); text-shadow: 0 0 5px var(--occult-primary);">
                        Initiating Dimensional Rift...
                    </h2> 

                    <h2 id="trackingTitle" class="text-2xl font-bold text-red-700 mb-2 hidden" style="color: var(--occult-glow-red); text-shadow: var(--occult-glow-shadow);">
                        VESSEL ACQUIRED: THE EYES OF KRONOS
                    </h2>
                    
                    <h2 class="text-xl font-semibold mb-2" style="color: var(--occult-secondary);">
                        Ritual State
                    </h2>
                    <div class="status-box p-3 text-sm">
                        <p class="text-gray-800" style="color: var(--occult-text);">
                            Access Seal: <span id="targetCoords" class="font-mono"></span>
                        </p>
                        
                        <!-- 1. Status during Loading (Initial state) -->
                        <p id="loadingStatus" class="font-bold mt-1" style="color: var(--occult-text);">
                            State: <span id="loadingStatusText">Establishing secure link...</span>
                        </p>

                        <!-- 2. Status during Tracking (Hidden until tracking starts) -->
                        <p id="trackingStatus" class="font-bold mt-1 hidden" style="color: #6AA84F;">
                            State: <span id="trackingStatusText">Link Active. Monitoring activity.</span>
                        </p>
                    </div>
                </div>
            </div>

            <!-- LOADING BAR AREA (Visible during 5-second search) -->
            <div id="loadingArea" class="flex justify-center flex-col items-center p-4">
                <h3 class="text-lg font-mono mb-3" style="color: var(--occult-primary);">
                    Channeling focus...
                </h3>
                <div class="w-full max-w-lg bg-gray-300 rounded-full h-4 relative overflow-hidden border border-gray-400" 
                     style="background-color: #311A4D; border-color: var(--occult-primary);">
                    <div id="progressBar" class="h-full rounded-full transition-all duration-100" 
                         style="width: 0%; background-color: var(--occult-primary);"></div>
                    <span id="progressText" class="absolute inset-0 flex items-center justify-center text-xs font-bold text-white text-shadow-sm">0%</span>
                </div>
            </div>

            <!-- COUNTDOWN AND VIDEO AREA -->
            <div class="flex justify-center flex-col items-center hidden" id="videoArea"> 
                <div class="text-center mt-4">
                    <h4 class="text-sm text-gray-400 mb-1" style="color: var(--occult-text);">
                        CYCLES UNTIL THE HARVEST
                    </h4>
                    <!-- Countdown Display (DD:HH:MM:SS) -->
                    <div id="countdownDisplay">100:00:00:00</div>
                </div>

                <!-- Main Video Feed Player -->
                <video id="mainVideoFeed" autoplay loop muted playsinline 
                       class="rounded-md"
                       poster="https://placehold.co/600x338/8b0000/FFFFFF?text=DIMENSIONAL+FEED+INITIATING">
                    <!-- *** PASTE YOUR PUBLIC VIDEO URL HERE (e.g., https://my-storage.com/video.mp4) *** -->
                    <source id="mainVideoSource" src="https://example.com/replace-me/your-live-feed.mp4" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
                
                <p class="text-sm mt-3 font-semibold hidden" id="videoErrorText" style="color: var(--occult-glow-red);">
                    The dimensional gateway has failed. Check scrying link.
                </p>
            </div>
        </div>
    </div>
    <!-- END MAIN WINDOW CONTAINER -->
    
    <!-- POPUP MODAL 2: ENDGAME ALERT (Hidden initially, appears when countdown hits zero) -->
    <div id="endgameModal" class="modal-overlay hidden occult-endgame-modal">
        <div class="occult-panel"> 
            <div class="occult-title-bar" style="margin: 0; background: var(--occult-glow-red); color: black;">
                <span style="color: black;">&#10008;</span> RITUAL CONSUMMATED
            </div>
            <div class="p-6 text-center space-y-4">
                <div class="flashing-text text-3xl" style="animation-duration: 0.2s; color: var(--occult-glow-red);">
                    TIME'S UP
                </div>
                
                <div class="flex justify-center my-4">
                    <video id="endgameVideo" autoplay loop muted playsinline 
                           poster="https://placehold.co/320x180/000000/FFFFFF?text=SIGNAL+LOST"
                           class="w-full max-w-xs border-5 border-red-600" style="border-radius: 0; box-shadow: var(--occult-glow-shadow);">
                        <!-- *** PASTE YOUR FINAL ALERT VIDEO URL HERE *** -->
                        <source src="https://example.com/replace-me/your-final-alert.mp4" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                </div>
                
                <p class="text-sm text-gray-400" style="margin-top: 20px; margin-bottom: 20px; color: var(--occult-text);">
                    Just like you searched for Ella, I wonder if anyone else will search for you?
                </p>
                
                <div class="flex justify-center mt-4">
                    <button id="closeEndgameButton" 
                            class="py-2 px-6 font-semibold occult-button-red"
                            style="min-width: 150px;">
                        Embrace the Void
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!-- END Modal 2 -->

    <!-- =========================================================================
     * JAVASCRIPT LOGIC (UNMODIFIED FUNCTIONALLY)
     * ========================================================================= -->
    <script>
        // --- CONFIGURATION: EDIT THESE VALUES ---
        const SECRET_PASSWORD = "CLUE"; // The required password
        const DEFAULT_VOLUME = 0.3; 
        const LOADING_DURATION_MS = 5000; 
        // 100 days in milliseconds: 100 * 24 * 60 * 60 * 1000 = 8640000000
        const INITIAL_COUNTDOWN_MS = 8640000000; 
        // ----------------------------------------
        
        let countdownInterval;
        let countdownEndTime; 

        // DOM REFERENCES
        const passwordInput = document.getElementById('passwordInput');
        const verifyButton = document.getElementById('verifyButton');
        const inputArea = document.getElementById('inputArea');
        const resultArea = document.getElementById('resultArea');
        const audioPlayer = document.getElementById('audioPlayer'); 
        
        // VIDEO ELEMENTS
        const mainVideoFeed = document.getElementById('mainVideoFeed');
        const videoErrorText = document.getElementById('videoErrorText');
        
        // STATUS & COUNTDOWN REFERENCES
        const loadingStatus = document.getElementById('loadingStatus'); 
        const trackingStatus = document.getElementById('trackingStatus'); 
        const countdownDisplay = document.getElementById('countdownDisplay'); 
        const targetCoordsText = document.getElementById('targetCoords');
        
        // Titles
        const loadingTitle = document.getElementById('loadingTitle');
        const trackingTitle = document.getElementById('trackingTitle');

        // MODALS
        const endgameModal = document.getElementById('endgameModal'); 
        const closeEndgameButton = document.getElementById('closeEndgameButton');
        
        // Other DOM references
        const loadingArea = document.getElementById('loadingArea');
        const progressBar = document.getElementById('progressBar');
        const progressText = document.getElementById('progressText');
        const videoArea = document.getElementById('videoArea');

        // =========================================================================
        // CORE FUNCTIONS
        // =========================================================================

        /**
         * Checks the input value against the secret password.
         */
        function checkPassword() {
            try {
                // Ensure the input field and button exist
                if (!passwordInput || !verifyButton) return;
                
                // Convert input to uppercase and trim whitespace for non-case-sensitive check
                const inputPasswordUpperCase = passwordInput.value.trim().toUpperCase();
                
                if (inputPasswordUpperCase === SECRET_PASSWORD) {
                    verifyButton.disabled = false;
                    verifyButton.onclick = triggerInitialActivation; 
                } else {
                    verifyButton.disabled = true;
                }
            } catch (error) {
                // Failsafe: keep button disabled if there's any error
                verifyButton.disabled = true;
            }
        }
        
        /**
         * Formats milliseconds into DD:HH:MM:SS string.
         * @param {number} ms - Milliseconds remaining.
         * @returns {string} Formatted countdown string.
         */
        function formatTime(ms) {
            if (ms < 0) ms = 0;
            const totalSeconds = Math.floor(ms / 1000);

            const days = String(Math.floor(totalSeconds / (3600 * 24))).padStart(2, '0');
            const hours = String(Math.floor((totalSeconds % (3600 * 24)) / 3600)).padStart(2, '0');
            const minutes = String(Math.floor((totalSeconds % 3600) / 60)).padStart(2, '0');
            const seconds = String(Math.floor(totalSeconds % 60)).padStart(2, '0');

            return `${days}:${hours}:${minutes}:${seconds}`;
        }

        /**
         * Starts the 100-day countdown timer.
         */
        function start100DayCountdown() {
            // Set the end time 100 days from now
            countdownEndTime = Date.now() + INITIAL_COUNTDOWN_MS;

            updateCountdown(); 
            
            countdownInterval = setInterval(updateCountdown, 1000); 
        }

        /**
         * Updates the countdown display every second.
         */
        function updateCountdown() {
            const timeRemaining = countdownEndTime - Date.now();
            countdownDisplay.textContent = formatTime(timeRemaining);

            if (timeRemaining <= 0) {
                clearInterval(countdownInterval);
                showEndgameModal();
            }
        }
        
        /**
         * Called when the countdown hits zero. Stops all processes and shows the final alert.
         */
        function showEndgameModal() {
            // 1. Clean up intervals and audio
            clearInterval(countdownInterval);
            audioPlayer.pause();
            
            // 2. Update status to reflect the end state
            trackingStatus.textContent = "State: THE RITUAL IS COMPLETE.";
            trackingStatus.classList.remove('text-green-600');
            trackingStatus.classList.add('text-red-600');
            
            // 3. Show the end game modal
            endgameModal.classList.remove('hidden');
        }

        /**
         * Starts the loading bar animation and sets a timeout to start the main sequence.
         */
        function startLoadingBar() {
            // Setup UI for loading phase
            loadingArea.classList.remove('hidden');
            videoArea.classList.add('hidden');
            
            trackingStatus.classList.add('hidden'); 
            loadingStatus.classList.remove('hidden'); 
            
            loadingTitle.classList.remove('hidden'); 
            trackingTitle.classList.add('hidden');   
            
            let progress = 0;
            progressBar.style.width = '0%';
            progressText.textContent = '0%';
            
            const totalTime = LOADING_DURATION_MS;
            const intervalTime = 100;
            const steps = totalTime / intervalTime;
            let currentStep = 0;

            const loadingInterval = setInterval(() => {
                currentStep++;
                if (currentStep <= steps) {
                    progress = Math.round((currentStep / steps) * 100);
                    progressBar.style.width = `${progress}%`;
                    progressText.textContent = `${progress}%`;

                    if (currentStep >= steps) {
                         clearInterval(loadingInterval);
                         startTrackingSequence(); 
                    }
                }
            }, intervalTime);
        }

        /**
         * Initiates the sequence after the correct password is entered.
         */
        function triggerInitialActivation() {
            // Update UI state (hide inputs, show results section)
            inputArea.classList.add('hidden');
            resultArea.classList.remove('hidden');
            targetCoordsText.textContent = "SEAL BROKEN";

            startLoadingBar();
        }


        /**
         * Starts the main audio loop, video, and the 100-day countdown.
         */
        function startTrackingSequence() { 
            // 1. Hide loading bar and status
            loadingArea.classList.add('hidden');
            loadingStatus.classList.add('hidden'); 
            
            // 2. Show the video area and the tracking status
            videoArea.classList.remove('hidden');
            trackingStatus.classList.remove('hidden'); 
            
            loadingTitle.classList.add('hidden');    
            trackingTitle.classList.remove('hidden'); 
            
            // 3. START MAIN AUDIO LOOP
            audioPlayer.volume = DEFAULT_VOLUME;
            audioPlayer.loop = true; 
            audioPlayer.play().catch(error => {
                console.error("Main audio autoplay failed.", error);
            });
            
            // 4. Start main video playback
            mainVideoFeed.play().catch(e => {
                console.warn("Main video autoplay failed. Showing error message.");
                videoErrorText.classList.remove('hidden'); 
            });

            // 5. Start the active countdown
            start100DayCountdown();
        }
        
        // =========================================================================
        // EVENT LISTENERS
        // =========================================================================

        // Audio Error Handling
        audioPlayer.addEventListener('error', (e) => {
             if (audioPlayer.networkState === audioPlayer.NETWORK_NO_SOURCE || audioPlayer.error?.code === 4) {
                 console.error("Audio network error detected. File link is likely inaccessible or corrupted.");
             }
        });
        
        // Video Error Handling (Main Feed)
        mainVideoFeed.addEventListener('error', (e) => {
            console.error("Main video error: Check file path and format.", e);
            videoErrorText.classList.remove('hidden');
        });

        // Handler to close the final endgame modal.
        closeEndgameButton.onclick = () => {
            endgameModal.classList.add('hidden');
        };

        // Initial setup
        window.onload = () => {
            checkPassword(); 
            audioPlayer.load();
            mainVideoFeed.load();
            
            // Set initial countdown display to 100 days
            countdownDisplay.textContent = formatTime(INITIAL_COUNTDOWN_MS);
        };
    </script>
</body>
</html>
